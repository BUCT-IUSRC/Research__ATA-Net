# ATA-Net: Asynchronous Temporal Attention for Real-World Multi-Modal 3D Object Detection

Yadong Wang，Sihan Chen，Tianyu Shen，Yongqiang Deng，Juanjuan Li，Kunfeng Wang

corresponding authors：Tianyu Shen and Kunfeng Wang

# Framework Overview

This paper proposes an asynchronous temporal attention model (ATA-Net) for real-world multi-modal 3D object detection. An asynchronous temporal attention is proposed for bi-directional interaction between image and sequential point clouds. Additionally, object-level dense point clouds are generated by combining visual guidance and optical flow estimation.

![](D:\AA成果\ATA-Net\撰写材料\论文绘图草稿 - 副本_02.png)

# **Install**

**The Environment:**

* Linux (tested on Ubuntu 16.04)
* Python 3.6+
* PyTorch 1.0+

Please refer to [PyTorch Docs](https://pytorch.org/get-started/previous-versions/) to install `torch` and `torchvision` for better compatibility.

**Dataset：**

V2X-Seq (cover to KITTI) ([DAIR-V2X车路协同数据集 (baai.ac.cn)](https://thudair.baai.ac.cn/coop-forecast))

# Run

## Training

Run ATA-Net for single gpu:

```python
CUDA_VISIBLE_DEVICES=0 python train_rcnn.py --cfg_file cfgs/xin_LI_Fusion_with_attention_use_ce_loss.yaml --batch_size 2 --train_mode rcnn_online --epochs 50 --ckpt_save_interval 1 --output_dir ./log/Car/full_epnet_without_iou_branch/
```

Run ATA-Net for two gpus:

```python
CUDA_VISIBLE_DEVICES=0,1 python train_rcnn.py --cfg_file cfgs/xin_LI_Fusion_with_attention_use_ce_loss.yaml --batch_size 2 --train_mode rcnn_online --epochs 50 --ckpt_save_interval 1 --output_dir ./log/Car/full_epnet_without_iou_branch/
```

## Testing

```
CUDA_VISIBLE_DEVICES=0 python eval_rcnn.py --cfg_file cfgs/xin_LI_Fusion_with_attention_use_ce_loss.yaml --eval_mode rcnn_online  --eval_all  --output_dir ./log/Car/full_epnet_without_iou_branch/eval_results/  --ckpt_dir ./log/Car/full_epnet_without_iou_branch/ckpt
```

# Acknowledgement

The code is based onEPNet.([happinesslz/EPNet: EPNet: Enhancing Point Features with Image Semantics for 3D Object Detection(ECCV 2020) (github.com)](https://github.com/happinesslz/EPNet). )

# Citation

Submission in progress

# Contact Us

If you have any problem about this work, please feel free to reach us out at `2021400212@buct.edu.cn`.
